import json


def remove_user_by_depth(depth, remove_users_id):
    remove_users_id = set(remove_users_id)
    for i in range(0, depth + 1):
        with open('../data/relatives-depth{}.json'.format(i), 'r') as f:
            user_info = json.load(f)
            for user in user_info:
                if int(user['user_id']) in remove_users_id:
                    user_info.remove(user)
                    for fan in user['fans_info']:
                        remove_users_id.add(int(fan['fan_id']))
                    print('Remove 1 user')
                else:
                    for fan in user['fans_info']:
                        if int(fan['fan_id']) in remove_users_id:
                            user['fans_info'].remove(fan)
                            print('Remove 1 fan')
                    for follower in user['followers_info']:
                        if int(follower['follower_id']) in remove_users_id:
                            user['followers_info'].remove(follower)
                            print('Remove 1 follower')
        with open('../data/test/relatives-depth{}.json'.format(i), 'w') as f:
            json.dump(user_info, f)


remove_user_by_depth(2, [2671109275, 5975746195, 3963374613, 3950863365, 6471310216, 7358449389, 7313246016, 7519927323,
                         7294633270, 6456516061, 7312330762, 6331766189, 5789719633, 6981731987, 5686912257, 2746760375,
                         5555811604, 6447744611, 6686153475, 6874960368, 3926764201, 6543728984, 6540400105, 6098359378,
                         5089097407, 6689566144, 6689825339, 5723587874, 3168615793, 5754304677, 5246125031, 5323294147,
                         5311962398, 3751126990, 2121420571, 1924983267, 2395641163, 2337479111, 1879652051, 3944611884,
                         1391996464, 1893354237, 5189265668, 1058539547, 6591624475, 3479691675, 3479691562, 3479691513,
                         3478888437, 3290004585, 3273136661, 3273136590, 3271991250, 3271991310, 3271991330, 6578945454,
                         7258843990, 3795942812, 5126163717, 3852254266, 3824570514, 3627259921, 3848724217, 3360322842,
                         3837030200, 3606713333, 6015858301, 5849121067, 3427822724, 3982265028, 5269515313, 3057936634,
                         6201598325, 6212641216, 6215415059, 6185052823, 5273074247, 5999309607, 6150562399, 3184833904,
                         5022105950, 5891105405, 5976270684, 3762477500, 5880208233, 3607841315, 2346013101, 6154088384,
                         6168405035, 3288478731, 6614392551, 5126574449, 3912293705, 6372128127, 1998800401, 5872414171,
                         5879240286, 5715240414, 5528944803, 5888776172, 2891330573, 6013015915, 6076188446, 5336347163,
                         2436082973, 6012264094, 6017351910, 6065923903, 6195506955, 6172736288, 5191131147, 5504510167,
                         5908081109, 5631568386, 5631795641, 5144172012, 3493196857, 6099270177, 5939188660, 6081229567,
                         6189754760, 5655166369, 5803058831, 5090742216, 5676969053, 1114376125, 1013230360, 3631086233,
                         6066007094, 6218353457, 6260250169, 5163638484, 1034097831, 6201578181, 6132510094, 3820152136,
                         5192595927, 5355702878, 5724835906, 6261142078, 6041422069, 5184803249, 5419197062, 2738360691,
                         6188040304, 6108000110, 5388326129, 6000815087, 6182247690, 5571975858, 6250716160, 6085647246,
                         5660825631, 5859403174, 6130818269, 3934977223, 5792369617, 6206498212, 5792745965, 6109801196,
                         5520137433, 6273519036, 6263430246, 5286059394, 5289850984, 1134475484, 6208852606, 6169537469,
                         5792102693, 5833549267, 5751732365, 2695682877, 1888511201, 2656722313, 6168415353, 5736764879,
                         6262359289, 5626744561, 6190437057, 5989801401, 6263588340, 5212542789, 5893849595, 6229528566,
                         3948766814, 5850778487, 5317701316, 3825000085, 5112706962, 3928637061, 6053953352, 5408134232,
                         6160805860, 6032708451, 3026951453, 6019621504, 6089360141, 5798168353, 3898288221, 5974287837,
                         5637672112, 6089384638, 3996907110, 6056471688, 5905936226, 5846596688, 5233858588, 5733473448,
                         6208053676, 5348123676, 5856213867, 1029786967, 5495199373, 5663998231, 6296374834, 6193102429,
                         6220148144, 5651672283, 5117535785, 5778838247, 6691443749, 7025068550, 6708433398, 6356542013,
                         6571744195, 6553968365, 3967469784, 6441273925, 6581764521, 6509169766, 6509179203, 6518177193,
                         6518179105, 6867129578, 6867117807])
